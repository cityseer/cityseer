<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cityseer API Docs</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:300,400,500">
    <meta name="description" content="Computational tools for urban analysis">
    
    <link rel="preload" href="/cityseer/assets/css/0.styles.7973ef14.css" as="style"><link rel="preload" href="/cityseer/assets/js/app.1c9af822.js" as="script"><link rel="preload" href="/cityseer/assets/js/2.0e550b61.js" as="script"><link rel="preload" href="/cityseer/assets/js/3.c6da7692.js" as="script"><link rel="preload" href="/cityseer/assets/js/9.392b743d.js" as="script"><link rel="prefetch" href="/cityseer/assets/js/10.dea527c1.js"><link rel="prefetch" href="/cityseer/assets/js/11.9b95ee82.js"><link rel="prefetch" href="/cityseer/assets/js/12.8d328176.js"><link rel="prefetch" href="/cityseer/assets/js/13.4af07594.js"><link rel="prefetch" href="/cityseer/assets/js/14.3331d28f.js"><link rel="prefetch" href="/cityseer/assets/js/15.614e8e57.js"><link rel="prefetch" href="/cityseer/assets/js/16.49ede94d.js"><link rel="prefetch" href="/cityseer/assets/js/17.49dafd2e.js"><link rel="prefetch" href="/cityseer/assets/js/18.f0929d5e.js"><link rel="prefetch" href="/cityseer/assets/js/19.661d4283.js"><link rel="prefetch" href="/cityseer/assets/js/20.6d941157.js"><link rel="prefetch" href="/cityseer/assets/js/21.4a6ceb26.js"><link rel="prefetch" href="/cityseer/assets/js/4.6cb1f27c.js"><link rel="prefetch" href="/cityseer/assets/js/5.38422aff.js"><link rel="prefetch" href="/cityseer/assets/js/6.9e608fe2.js"><link rel="prefetch" href="/cityseer/assets/js/7.1142b35d.js"><link rel="prefetch" href="/cityseer/assets/js/8.168c6aa5.js">
    <link rel="stylesheet" href="/cityseer/assets/css/0.styles.7973ef14.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/cityseer/" class="home-link router-link-active"><img src="/cityseer/round_logo.png" alt="Cityseer API Docs" class="logo"> <span class="site-name can-hide">Cityseer API Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/cityseer/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/cityseer/intro.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  docs
</a></div><div class="nav-item"><a href="https://cityseer.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cityseer.io
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/cityseer/cityseer" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/cityseer/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/cityseer/intro.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  docs
</a></div><div class="nav-item"><a href="https://cityseer.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cityseer.io
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/cityseer/cityseer" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>overview</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cityseer/intro.html" aria-current="page" class="active sidebar-link">intro</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cityseer/intro.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/cityseer/intro.html#issues-contributions" class="sidebar-link">Issues &amp; Contributions</a></li></ul></li><li><a href="/cityseer/attribution.html" class="sidebar-link">attribution</a></li><li><a href="/cityseer/license.html" class="sidebar-link">license</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cityseer/guide/cleaning.html" class="sidebar-link">graph cleaning</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>cityseer.metrics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cityseer/metrics/layers.html" class="sidebar-link">metrics.layers</a></li><li><a href="/cityseer/metrics/networks.html" class="sidebar-link">metrics.networks</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>cityseer.util</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cityseer/util/graphs.html" class="sidebar-link">util.graphs</a></li><li><a href="/cityseer/util/mock.html" class="sidebar-link">util.mock</a></li><li><a href="/cityseer/util/plot.html" class="sidebar-link">util.plot</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cityseer"><a href="#cityseer" class="header-anchor">#</a> cityseer <div class="chip-style">
  beta
</div></h1> <p><code>cityseer</code> is a collection of computational tools for fine-grained network and land-use analysis, useful for assessing the morphological precursors to vibrant neighbourhoods. It is underpinned by rigorous network-based methods that have been developed from the ground-up specifically for hyperlocal analysis at the pedestrian scale.</p> <p>The use of <code>python</code> facilitates interaction with popular tools for network, geospatial, and scientific data analysis, i.e. <a href="https://networkx.github.io/" target="_blank" rel="noopener noreferrer"><code>networkX</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://shapely.readthedocs.io" target="_blank" rel="noopener noreferrer"><code>shapely</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and the <a href="http://www.numpy.org/" target="_blank" rel="noopener noreferrer"><code>numpy</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> stack. The underlying algorithms are designed for efficient large-scale urban analysis and have been implemented in <a href="https://numba.pydata.org/" target="_blank" rel="noopener noreferrer"><code>numba</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> JIT compiled code.</p> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p><code>cityseer</code> is a <code>python</code> package that can be installed with <code>pip</code>:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pip <span class="token function">install</span> cityseer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Code tests are run against <code>python 3.8</code>.</p> <p><a href="https://github.com/cityseer/cityseer/actions" target="_blank" rel="noopener noreferrer"><img src="https://github.com/cityseer/cityseer/workflows/publish%20package/badge.svg" alt="Actions Status"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/cityseer/cityseer/actions" target="_blank" rel="noopener noreferrer"><img src="https://github.com/cityseer/cityseer/workflows/publish%20docs/badge.svg" alt="Actions Status"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>A notebook of this guide can be found at <a href="https://hub-binder.mybinder.ovh/user/cityseer-cityseer-mq3erq3w/notebooks/demo_notebooks/getting_started.ipynb" target="_blank" rel="noopener noreferrer">binder<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
Quickstart</p></blockquote> <hr> <p><code>cityseer</code> revolves around networks (graphs). If you're comfortable with <code>numpy</code> and abstract data handling, then the underlying data structures can be created and manipulated directly. However, it is generally more convenient to sketch the graph using <a href="https://networkx.github.io/" target="_blank" rel="noopener noreferrer"><code>NetworkX</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and to let <code>cityseer</code> take care of initialising and converting the graph for you.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># any networkX graph with 'x' and 'y' node attributes will do</span>
<span class="token comment"># here we'll use the cityseer mock module to generate an example networkX graph</span>
<span class="token keyword">from</span> cityseer<span class="token punctuation">.</span>util <span class="token keyword">import</span> mock
G <span class="token operator">=</span> mock<span class="token punctuation">.</span>mock_graph<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
import networkX as nx
print(nx.info(G))
# Name: 
# Type: Graph
# Number of nodes: 56
# Number of edges: 77
# Average degree:   2.7500
'''</span>
<span class="token comment"># let's plot the network</span>
<span class="token keyword">from</span> cityseer<span class="token punctuation">.</span>util <span class="token keyword">import</span> plot
plot<span class="token punctuation">.</span>plot_nX<span class="token punctuation">(</span>G<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># NOTE: this code block combines with the following blocks for a continuous example</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><img src="/cityseer/assets/img/graph.486b61aa.png" alt="Example graph" class="centre" style="max-height:500px;"> <p>The <a href="/cityseer/util/graphs.html"><code>util.graphs</code></a> module contains a collection of convenience functions for the preparation and conversion of <code>networkX</code> graphs. These functions are designed to work with raw <code>shapely</code> <a href="https://shapely.readthedocs.io/en/latest/manual.html#linestrings" target="_blank" rel="noopener noreferrer"><code>Linestring</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> geometries that have been assigned to the edge (link) <code>geom</code> attributes. The benefit to this approach is that the geometry of the network is decoupled from the topology: the topology is consequently free from distortions which would otherwise confound centrality and other metrics.</p> <p>There are generally two scenarios when creating a street network graph:</p> <ol><li><p>In the ideal case, if you have access to a high-quality street network dataset -- which keeps the topology of the network separate from the geometry of the streets -- then you would construct the network based on the topology while assigning the roadway geometries to the respective edges spanning the nodes. <a href="https://www.ordnancesurvey.co.uk/business-and-government/products/os-open-roads.html" target="_blank" rel="noopener noreferrer">OS Open Roads<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a good example of this type of dataset. Assigning the geometries to an edge involves A) casting the geometry to a <a href="https://shapely.readthedocs.io" target="_blank" rel="noopener noreferrer"><code>shapely</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>LineString</code>, and B) assigning this geometry to the respective edge by adding the <code>LineString</code> geometry as a <code>geom</code> attribute. i.e. <code>G[start_node][end_node]['geom'] = linestring_geom</code>.</p></li> <li><p>In reality, most data-sources are not this refined and will represent roadway geometries by adding additional nodes to the network. For a variety of reasons, this is not ideal and you may want to follow the <a href="/guide/cleaning"><code>Graph Cleaning</code></a> guide; in these cases, the <a href="/cityseer/util/graphs.html#nx-simple-geoms"><code>graphs.nX_simple_geoms</code></a> method can be used to generate the street geometries, after which several methods can be applied to remove frivolous nodes. For example, <a href="/cityseer/util/graphs.html#nx-wgs-to-utm"><code>nX_wgs_to_utm</code></a> for coordinate conversions; <a href="/cityseer/util/graphs.html#nx-remove-dangling-nodes"><code>nX_remove_dangling_nodes</code></a> to remove roadway stubs, <a href="/cityseer/util/graphs.html#nx-remove-filler-nodes"><code>nX_remove_filler_nodes</code></a> to strip-out filler nodes, and <a href="/cityseer/util/graphs.html#nx-consolidate-parallel"><code>nX_consolidate_parallel</code></a> to further simplify the network.</p></li></ol> <p><img src="/cityseer/assets/img/graph_decomposed.bb62654b.png" alt="Example 100m decomposed graph" class="left"><img src="/cityseer/assets/img/graph_dual.82fbb7de.png" alt="Example dual graph" class="right"></p> <p><em>A <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-math></mjx-container> decomposed variant of the graph (left) and an example primal / dual transformation of the (undecomposed) graph (right). Decomposed or &quot;ghosted&quot; nodes provide granular snapshots at regular intervals along streetfronts.</em></p> <p>Once the network is prepared, <a href="/cityseer/util/graphs.html#nx-decompose"><code>nX_decompose</code></a> can be used for the purpose of generating granular graph representations; whereas <a href="/cityseer/util/graphs.html#nx-to-dual"><code>nX_to_dual</code></a> can be used to cast a primal graph representation to its dual.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> cityseer<span class="token punctuation">.</span>util <span class="token keyword">import</span> graphs
<span class="token comment"># provide your own shapely geometries if you need precise street lengths / angles</span>
<span class="token comment"># else, auto-generate simple geometries from the start to end node of each network edge</span>
G <span class="token operator">=</span> graphs<span class="token punctuation">.</span>nX_simple_geoms<span class="token punctuation">(</span>G<span class="token punctuation">)</span>

<span class="token comment"># optionally decompose (or cast to dual)</span>
G <span class="token operator">=</span> graphs<span class="token punctuation">.</span>nX_decompose<span class="token punctuation">(</span>G<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The <code>networkX</code> graph can now be transformed into a <a href="/cityseer/metrics/networks.html#network-layer"><code>Network_Layer</code></a> by invoking <a href="/cityseer/metrics/networks.html#network-layer-from-nx"><code>Network_Layer_From_nX</code></a>. Network layers are used for network centrality computations and also provide the backbone for subsequent landuse and statistical aggregations. They must be initialised with a set of distances <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="a"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="x"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container> specifying the maximum network-distance thresholds at which the local centrality methods will terminate.</p> <p>The <a href="/cityseer/metrics/networks.html#compute-centrality"><code>Network_Layer.compute_centrality</code></a> method wraps underlying numba optimised functions that compute a range of centrality methods. These are performed simultaneously for any required combinations of measures and distances. The results of the computations will be written to the <code>Network_Layer</code> class, and can be accessed at the <code>Network_Layer.metrics</code> property. It is also possible to extract the data to a <code>python</code> dictionary through use of the <a href="/cityseer/metrics/networks.html#metrics-to-dict"><code>Network_Layer.metrics_to_dict</code></a> method, or to simply convert the network — data and all — back into a <code>networkX</code> layer with the <a href="/cityseer/metrics/networks.html#to-networkx"><code>Network_Layer.to_networkX</code></a> method.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> cityseer<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> networks
<span class="token comment"># create a Network layer from the networkX graph</span>
N <span class="token operator">=</span> networks<span class="token punctuation">.</span>Network_Layer_From_nX<span class="token punctuation">(</span>G<span class="token punctuation">,</span> distances<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">1600</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># the underlying method allows the computation of various centralities simultaneously, e.g.</span>
N<span class="token punctuation">.</span>compute_centrality<span class="token punctuation">(</span>measures<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'segment_harmonic'</span><span class="token punctuation">,</span> <span class="token string">'segment_betweenness'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Categorical and numerical data can be assigned to the network as a <a href="/cityseer/metrics/layers.html#data-layer"><code>Data_Layer</code></a>. A <code>Data_Layer</code> represents the spatial locations of data points, and is used for the calculation of various mixed-use, land-use accessibility, and statistical measures. These measures are computed directly over the street network and offer distance-weighted variants. This makes them more contextually sensitive than methods based on simple crow-flies aggregation.</p> <p>As with Network Layers, the underlying data structures can be created and manipulated directly. However, it is generally simpler to create a python dictionary containing the <code>x</code> and <code>y</code> node attributes for each data point, and to then use <a href="/cityseer/metrics/layers.html#data-layer-from-dict"><code>Data_Layer_From_Dict</code></a> to instance a <code>Data_Layer</code> directly. After instantiation, the <code>Data_Layer</code> is then assigned to the <code>Network_Layer</code> through use of the <a href="/cityseer/metrics/layers.html#assign-to-network"><code>Data_Layer.assign_to_network</code></a> method.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> cityseer<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> layers
<span class="token comment"># a mock data dictionary representing the 'x', 'y' attributes for data points</span>
data_dict <span class="token operator">=</span> mock<span class="token punctuation">.</span>mock_data_dict<span class="token punctuation">(</span>G<span class="token punctuation">,</span> random_seed<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token comment"># generate a data layer</span>
D <span class="token operator">=</span> layers<span class="token punctuation">.</span>Data_Layer_From_Dict<span class="token punctuation">(</span>data_dict<span class="token punctuation">)</span>
<span class="token comment"># assign to the prior Network Layer</span>
<span class="token comment"># max_dist represents the farthest to search for adjacent street edges</span>
D<span class="token punctuation">.</span>assign_to_network<span class="token punctuation">(</span>N<span class="token punctuation">,</span> max_dist<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The data points will be assigned to the two closest network nodes — one in either direction — based on the closest adjacent street edge. This enables a dynamic spatial aggregation method that more accurately describes distances over the network to data points, relative to the direction of approach.</p> <p><img src="/cityseer/assets/img/assignment.6a2d66c5.png" alt="Example assignment of data to a network" class="left"><img src="/cityseer/assets/img/assignment_decomposed.4ca4dc49.png" alt="Example assignment on a decomposed network" class="right"></p> <p><em>Data assigned to the network (left); note that assignment becomes more contextually precise on decomposed graphs (right).</em></p> <p>Once the data has been assigned, the <a href="/cityseer/metrics/layers.html#compute-aggregated"><code>Data_Layer.compute_aggregated</code></a> method is used for the calculation of mixed-use, accessibility, and statistical measures. As with the <code>Network_Layer.compute_centrality</code> method, the measures are all computed simultaneously (and for all distances); however, simpler stand-alone methods are also available, including: <a href="/cityseer/metrics/layers.html#hill-diversity"><code>Data_Layer.hill_diversity</code></a>, <a href="/cityseer/metrics/layers.html#hill-branch-wt-diversity"><code>Data_Layer.hill_branch_wt_diversity</code></a>, <a href="/cityseer/metrics/layers.html#compute-accessibilities"><code>Data_Layer.compute_accessibilities</code></a>, <a href="/cityseer/metrics/layers.html#compute-stats-single"><code>Data_Layer.compute_stats_single</code></a>, and <a href="/cityseer/metrics/layers.html#compute-stats-multiple"><code>Data_Layer.compute_stats_multiple</code></a>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># landuse labels can be used to generate mixed-use and land-use accessibility measures</span>
<span class="token comment"># for demonstration purposes, lets create mock landuse labels for the points in our data dictionary</span>
landuse_labels <span class="token operator">=</span> mock<span class="token punctuation">.</span>mock_categorical_data<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_dict<span class="token punctuation">)</span><span class="token punctuation">,</span> random_seed<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token comment"># example easy-wrapper method for computing mixed-uses</span>
<span class="token comment"># the hill q paramater controls the emphasis on unique land-uses vs. balanced preponderances thereof</span>
D<span class="token punctuation">.</span>hill_branch_wt_diversity<span class="token punctuation">(</span>landuse_labels<span class="token punctuation">,</span> qs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># example easy-wrapper method for computing accessibilities</span>
<span class="token comment"># the keys correspond to keys present in the landuse data for which accessibilities will be computed</span>
D<span class="token punctuation">.</span>compute_accessibilities<span class="token punctuation">(</span>landuse_labels<span class="token punctuation">,</span> accessibility_keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># or compute multiple measures at once, e.g.:</span>
D<span class="token punctuation">.</span>compute_aggregated<span class="token punctuation">(</span>landuse_labels<span class="token punctuation">,</span>
                     mixed_use_keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'hill'</span><span class="token punctuation">,</span> <span class="token string">'hill_branch_wt'</span><span class="token punctuation">,</span> <span class="token string">'shannon'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     accessibility_keys<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                     qs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># let's generate some mock numerical data for the points in our data dictionary</span>
mock_valuations_data <span class="token operator">=</span> mock<span class="token punctuation">.</span>mock_numerical_data<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data_dict<span class="token punctuation">)</span><span class="token punctuation">,</span> random_seed<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
<span class="token comment"># compute max, min, mean, mean-weighted, variance, and variance-weighted</span>
D<span class="token punctuation">.</span>compute_stats_single<span class="token punctuation">(</span>stats_key<span class="token operator">=</span><span class="token string">'valuations'</span><span class="token punctuation">,</span> stats_data_arr<span class="token operator">=</span>mock_valuations_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>The data is aggregated and computed over the street network relative to the <code>Network_Layer</code> (i.e. street) nodes. The mixed-use, accessibility, and statistical aggregations can therefore be compared directly to centrality computations from the same locations, and can be correlated or otherwise compared. The outputs of the calculations are written to the corresponding node indices in the same <code>Network_Layer.metrics</code> dictionary used for centrality methods, and will be categorised by the respective keys and parameters.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># access the data arrays at the respective keys, e.g.</span>
distance_idx <span class="token operator">=</span> <span class="token number">800</span>  <span class="token comment"># any of the initialised distances</span>
q_idx <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># q index: any of the invoked q parameters</span>
node_idx <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># a node idx</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'centrality keys:'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'centrality'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># prints: centrality keys: ['segment_harmonic', 'segment_betweenness']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'distance keys:'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'centrality'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'segment_harmonic'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># prints: distance keys: [200, 400, 800, 1600]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'centrality'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'segment_harmonic'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>distance_idx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># prints: [36.46092  34.097134 29.37572  28.52696 ]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'mixed-use keys:'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'mixed_uses'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># prints: mixed-use keys: ['hill_branch_wt', 'hill', 'shannon']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'mixed_uses'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'hill_branch_wt'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>q_idx<span class="token punctuation">]</span><span class="token punctuation">[</span>distance_idx<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># prints: [3.77794601 3.38890755 3.68395318 2.67093971]</span>

<span class="token comment"># statistical keys can be retrieved the same way:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'stats keys:'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'stats'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># prints: stats keys: ['valuations']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'valuations keys:'</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'stats'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'valuations'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># prints: valuations keys: ['max', 'min', 'sum', 'sum_weighted', 'mean', 'mean_weighted', 'variance', 'variance_weighted']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'valuations weighted by 1600m decay:'</span><span class="token punctuation">,</span> N<span class="token punctuation">.</span>metrics<span class="token punctuation">[</span><span class="token string">'stats'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'valuations'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'mean_weighted'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1600</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># prints: valuations weighted by 1600m decay: [54197.16775872 52605.12914212 49085.95351109 52261.44967792]</span>


<span class="token comment"># the data can also be convert back to a NetworkX graph</span>
G_metrics <span class="token operator">=</span> N<span class="token punctuation">.</span>to_networkX<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>nx<span class="token punctuation">.</span>info<span class="token punctuation">(</span>G_metrics<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># the data arrays are unpacked accordingly</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>G_metrics<span class="token punctuation">.</span>nodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'metrics'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'centrality'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'segment_betweenness'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># prints: 590.8659</span>

<span class="token comment"># the data can also be extracted to a dictionary:</span>
N<span class="token punctuation">.</span>metrics_to_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>G_dict<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'centrality'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'segment_betweenness'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># prints: 590.8659</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>The data can then be passed to data analysis or plotting methods. For example, the <a href="/cityseer/util/plot.html"><code>util.plot</code></a> module can be used to plot the segmentised harmonic closeness centrality and mixed uses for the above mock data:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># plot centrality</span>
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> colors

segment_harmonic_vals <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
mixed_uses_vals <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> node<span class="token punctuation">,</span> data <span class="token keyword">in</span> G_metrics<span class="token punctuation">.</span>nodes<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    segment_harmonic_vals<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'metrics'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'centrality'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'segment_harmonic'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    mixed_uses_vals<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'metrics'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'mixed_uses'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'hill_branch_wt'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># custom colourmap</span>
cmap <span class="token operator">=</span> colors<span class="token punctuation">.</span>LinearSegmentedColormap<span class="token punctuation">.</span>from_list<span class="token punctuation">(</span><span class="token string">'cityseer'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'#64c1ff'</span><span class="token punctuation">,</span> <span class="token string">'#d32f2f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># normalise the values</span>
segment_harmonic_vals <span class="token operator">=</span> colors<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>segment_harmonic_vals<span class="token punctuation">)</span>
<span class="token comment"># cast against the colour map</span>
segment_harmonic_cols <span class="token operator">=</span> cmap<span class="token punctuation">(</span>segment_harmonic_vals<span class="token punctuation">)</span>
<span class="token comment"># plot segment_harmonic</span>
plot<span class="token punctuation">.</span>plot_nX<span class="token punctuation">(</span>G_metrics<span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> colour<span class="token operator">=</span>segment_harmonic_cols<span class="token punctuation">)</span>

<span class="token comment"># plot distance-weighted hill mixed uses</span>
mixed_uses_vals <span class="token operator">=</span> colors<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>mixed_uses_vals<span class="token punctuation">)</span>
mixed_uses_cols <span class="token operator">=</span> cmap<span class="token punctuation">(</span>mixed_uses_vals<span class="token punctuation">)</span>
plot<span class="token punctuation">.</span>plot_assignment<span class="token punctuation">(</span>N<span class="token punctuation">,</span> D<span class="token punctuation">,</span> node_colour<span class="token operator">=</span>mixed_uses_cols<span class="token punctuation">,</span> data_labels<span class="token operator">=</span>landuse_labels<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><img src="/cityseer/assets/img/intro_segment_harmonic.0438f983.png" alt="Example gravity index plot" class="left"><img src="/cityseer/assets/img/intro_mixed_uses.b9358dac.png" alt="Example mixed uses plot" class="right"></p> <p><em><mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="8"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-math></mjx-container> segmentised harmonic closeness centrality (left) and <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="4"></mjx-c><mjx-c c="0"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-math></mjx-container> branch-weighted mixed-uses (right) plots on a <mjx-container jax="CHTML" class="MathJax"><mjx-math class=" MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="2"></mjx-c><mjx-c c="0"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c c="m"></mjx-c></mjx-mi></mjx-math></mjx-container> decomposed graph.</em></p> <h2 id="issues-contributions"><a href="#issues-contributions" class="header-anchor">#</a> Issues &amp; Contributions</h2> <p>Please report issues to the <a href="https://github.com/cityseer/cityseer-api/issues" target="_blank" rel="noopener noreferrer"><code>issues</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> page of the <code>cityseer</code> <code>github</code> repo.</p> <p>Feature requests and contributions are welcome, and will be considered if within the remit of the package.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/12/2020, 9:08:18 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/cityseer/attribution.html">
        attribution
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/cityseer/assets/js/app.1c9af822.js" defer></script><script src="/cityseer/assets/js/2.0e550b61.js" defer></script><script src="/cityseer/assets/js/3.c6da7692.js" defer></script><script src="/cityseer/assets/js/9.392b743d.js" defer></script>
  </body>
</html>
